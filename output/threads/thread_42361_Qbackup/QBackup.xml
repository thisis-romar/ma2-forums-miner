<?xml version="1.0" encoding="utf-8"?>
<MA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.malighting.de/grandma2/xml/MA" xsi:schemaLocation="http://schemas.malighting.de/grandma2/xml/MA http://schemas.malighting.de/grandma2/xml/3.0.0/MA.xsd" major_vers="3" minor_vers="0" stream_vers="0">
	<Info datetime="2014-07-04T22:42:19" showfile="glad" />
	<Macro index="0" name="QBackup">
		<Macroline index="0">
			<text>SetUserVar $backup=&quot;QBackup &quot;</text>
			<info>Create unique label for backupseq</info>
		</Macroline>
		<Macroline index="1">
			<text>AddUserVar $backup=$&quot;date&quot;</text>
			<info>by adding current date</info>
		</Macroline>
		<Macroline index="2">
			<text>AddUserVar $backup=&quot; &quot;</text>
			<info>and</info>
		</Macroline>
		<Macroline index="3">
			<text>AddUserVar $backup=$&quot;time&quot;</text>
			<info>by adding current time</info>
		</Macroline>
		<Macroline index="4">
			<text>Store Sequence $&quot;backup&quot; Cue 0.001</text>
			<info>create backupseq via dummy cue</info>
		</Macroline>
		<Macroline index="5">
			<text>SetUserVar $from=(&quot;backup from cue&quot;)</text>
			<info>input cuerange start</info>
		</Macroline>
		<Macroline index="6">
			<text>SetUserVar $to=(&quot;backup to cue&quot;)</text>
			<info>input cuerange end</info>
		</Macroline>
		<Macroline index="7">
			<text>Copy Cue $from Thru $to At Sequence $&quot;backup&quot; Cue $from /status=false /cueonly=false</text>
			<info>copy cuerange to backupseq</info>
		</Macroline>
		<Macroline index="8">
			<text>Copy Cue $from At Sequence $&quot;backup&quot; Cue $from /merge /status /cueonly=false</text>
			<info>also copy status of cuerange start, to avoid tracking issues</info>
		</Macroline>
		<Macroline index="9">
			<text>Call Sequence $&quot;backup&quot; Cue 0.001</text>
			<info>restore programmer, if not empty when dummy cue was created</info>
		</Macroline>
		<Macroline index="10">
			<text>Delete Sequence $&quot;backup&quot; Cue 0.001 /nc</text>
			<info>remove dummy cue</info>
		</Macroline>
	</Macro>
	<Macro index="1" name="Archive old Qbackups">
		<Macroline index="0">
			<text>SetUserVar $all=&quot;Qbackup*&quot;</text>
			<info>namematch for all Qbackups</info>
		</Macroline>
		<Macroline index="1">
			<text>SetUserVar $today=&quot;Qbackup &quot;</text>
			<info>namematch for todays backups</info>
		</Macroline>
		<Macroline index="2">
			<text>AddUserVar $today=$&quot;date&quot;</text>
			<info>by adding current date</info>
		</Macroline>
		<Macroline index="3">
			<text>AddUserVar $today=&quot; *&quot;</text>
			<info>and wildcard for time</info>
		</Macroline>
		<Macroline index="4">
			<text>Export Sequence $&quot;all&quot; - $&quot;today&quot; (&quot;Enter filename&quot;)</text>
			<info>Export all qbackups apart today&apos;s</info>
		</Macroline>
		<Macroline index="5">
			<text>Delete Sequence $&quot;all&quot; - $&quot;today&quot;</text>
			<info>Delete exported qbackups</info>
		</Macroline>
	</Macro>
</MA>